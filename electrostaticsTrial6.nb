(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11617,        256]
NotebookOptionsPosition[     11300,        242]
NotebookOutlinePosition[     11662,        258]
CellTagsIndexPosition[     11619,        255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Block", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "R", ",", "Er", ",", "Et", ",", "func", ",", "M", ",", "n", ",", "m", ",",
      "k", ",", "I1", ",", "I2", ",", "I3", ",", "A1", ",", "\[Phi]", ",", 
     "eq1", ",", "eq2", ",", "var", ",", "soln"}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"M", "=", "0"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"The", " ", "number", " ", "of", " ", "coefficients"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"n", "=", "2"}], ";", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"Curvature", " ", "exponents"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"R", "=", "10"}], ";", 
    RowBox[{"(*", " ", 
     RowBox[{
     "The", " ", "range", " ", "of", " ", "the", " ", "stretch", " ", "of", 
      " ", "the", " ", "conveyor", " ", "belt"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"I1", "=", 
     RowBox[{"<|", "|>"}]}], ";", 
    RowBox[{"I2", "=", 
     RowBox[{"<|", "|>"}]}], ";", 
    RowBox[{"I3", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"k", "=", "0"}], ",", 
      RowBox[{"k", "<", "M"}], ",", 
      RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"For", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", "1"}], ",", 
        RowBox[{"m", "\[LessEqual]", "M"}], ",", 
        RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"I1", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"I1", ",", 
            RowBox[{"k", "\[Rule]", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Log", "[", 
                 RowBox[{"func", "[", 
                  RowBox[{"\[Theta]", ",", "n"}], "]"}], "]"}], 
                RowBox[{"Cos", "[", 
                 RowBox[{"k", " ", "\[Theta]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"I2", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"I2", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "k"}], "}"}], "\[Rule]", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"func", "[", 
                  RowBox[{"\[Theta]", ",", "n"}], "]"}], "^", "m"}], " ", 
                RowBox[{"Cos", "[", 
                 RowBox[{"m", " ", "\[Theta]"}], "]"}], 
                RowBox[{"Cos", "[", 
                 RowBox[{"k", " ", "\[Theta]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"I3", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"I3", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"m", ",", "k"}], "}"}], "\[Rule]", 
             RowBox[{"NIntegrate", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"func", "[", 
                  RowBox[{"\[Theta]", ",", "n"}], "]"}], "^", "m"}], " ", 
                RowBox[{"Sin", "[", 
                 RowBox[{"m", " ", "\[Theta]"}], "]"}], 
                RowBox[{"Cos", "[", 
                 RowBox[{"k", " ", "\[Theta]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "0", ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
         ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"eq1", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"I1", "[", "k", "]"}], "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"A1", "[", "m", "]"}], 
            RowBox[{"I2", "[", 
             RowBox[{"{", 
              RowBox[{"m", ",", "k"}], "}"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"m", ",", "1", ",", "M"}], "}"}]}], "]"}]}], "\[Equal]", 
        "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"eq2", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"m", " ", 
           RowBox[{"A1", "[", "m", "]"}], 
           RowBox[{"I3", "[", 
            RowBox[{"{", 
             RowBox[{"m", ",", "k"}], "}"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"m", ",", "1", ",", "M"}], "}"}]}], "]"}], "\[Equal]", 
        "0"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "0", ",", 
         RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"var", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"A1", "[", "m", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "M"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"soln", "=", 
     RowBox[{"NSolve", "[", 
      RowBox[{
       RowBox[{"Join", "[", 
        RowBox[{"eq1", ",", "eq2"}], "]"}], ",", "var", ",", "Reals", ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "10"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "soln", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.819813494811406*^9, 3.819813559622765*^9}, {
   3.8198141617635403`*^9, 3.819814390146278*^9}, {3.819814483699347*^9, 
   3.819814563796134*^9}, {3.819814966667193*^9, 3.819815046029443*^9}, {
   3.819815217697175*^9, 3.819815308420154*^9}, {3.819815350248487*^9, 
   3.819815382520404*^9}, {3.819815428757041*^9, 3.819815491476737*^9}, {
   3.819815533122335*^9, 3.819815678740944*^9}, {3.819815783779993*^9, 
   3.819815793208197*^9}, {3.819815861462245*^9, 3.819816031297401*^9}, {
   3.819816068049889*^9, 3.8198161145599613`*^9}, {3.8198161449577007`*^9, 
   3.819816281324201*^9}, {3.819816352417989*^9, 3.819816363288352*^9}, {
   3.8198167290419827`*^9, 3.819816752331448*^9}, 3.8198167861911297`*^9, {
   3.819818018000717*^9, 3.819818080915291*^9}, {3.8198181268989773`*^9, 
   3.819818168138719*^9}, {3.8198182903270807`*^9, 3.8198182914769907`*^9}, {
   3.8198245447139177`*^9, 3.8198245487368517`*^9}, {3.819828692403582*^9, 
   3.81982869420868*^9}, {3.819828858723093*^9, 3.819828860326914*^9}, {
   3.819829391668283*^9, 3.8198294104062853`*^9}, {3.819829471275083*^9, 
   3.8198294960295362`*^9}, {3.8198324198725977`*^9, 3.819832493611717*^9}, {
   3.8198325236530848`*^9, 3.8198325237929363`*^9}, {3.819832649432242*^9, 
   3.819832729351954*^9}, {3.819833635108725*^9, 3.819833761065628*^9}, {
   3.819833861956305*^9, 3.819833996141218*^9}, {3.819834059182302*^9, 
   3.819834220438651*^9}, {3.81983429610905*^9, 3.819834296609562*^9}, {
   3.819834503949888*^9, 3.8198345075449877`*^9}, {3.819834593263392*^9, 
   3.819834593640334*^9}, {3.819834674372499*^9, 3.819834683432311*^9}, {
   3.819834723285637*^9, 3.819834723557897*^9}, {3.819835073781419*^9, 
   3.819835087583016*^9}, {3.8198400811513767`*^9, 3.81984012846308*^9}, {
   3.819840165902714*^9, 3.81984016914989*^9}, {3.819840453589177*^9, 
   3.819840455373165*^9}, {3.819840592382249*^9, 3.819840599144762*^9}, {
   3.819840820207505*^9, 3.819840863410775*^9}, {3.819841001785781*^9, 
   3.8198410111383867`*^9}, {3.8198418756107197`*^9, 
   3.8198419258385553`*^9}, {3.8198419966001062`*^9, 3.819842007081052*^9}, {
   3.819842043946642*^9, 3.819842048387741*^9}, {3.8198427990841103`*^9, 
   3.819842800356333*^9}, {3.819842853147962*^9, 3.8198428592806377`*^9}, {
   3.819842941875004*^9, 3.819842963973732*^9}, {3.8198431015912237`*^9, 
   3.819843102107954*^9}, {3.819843172967959*^9, 3.81984317681952*^9}, {
   3.819843207950882*^9, 3.819843208390485*^9}, {3.81984326371883*^9, 
   3.819843264509962*^9}, {3.8198433509112043`*^9, 3.81984337849006*^9}, {
   3.8198437547170677`*^9, 3.8198437582401047`*^9}, {3.819843920540936*^9, 
   3.819843923653014*^9}, {3.819843994473897*^9, 3.8198440258207903`*^9}, {
   3.819844064729965*^9, 3.819844065356258*^9}, 3.819844114317657*^9, {
   3.819844199524624*^9, 3.819844244975541*^9}, 3.819844286724452*^9, {
   3.8198443339474897`*^9, 3.819844344427351*^9}, {3.8198443811107607`*^9, 
   3.819844381596518*^9}, {3.819844423415181*^9, 3.819844432646093*^9}, {
   3.8198446347808027`*^9, 3.8198446365827227`*^9}, {3.819844938945466*^9, 
   3.819844944323598*^9}, {3.819844987142715*^9, 3.819844988493598*^9}, {
   3.819845110356843*^9, 3.819845115087048*^9}, {3.8198452267912073`*^9, 
   3.819845229076767*^9}, {3.819845280401425*^9, 3.8198452845426598`*^9}, 
   3.8198453154237957`*^9, 3.819845346830544*^9, {3.819845399539008*^9, 
   3.81984540234196*^9}, 3.819845435792974*^9, {3.819845469311298*^9, 
   3.819845473912499*^9}, {3.819845665702433*^9, 3.819845672503483*^9}, {
   3.819845711025173*^9, 3.81984571623674*^9}, {3.8198457508083353`*^9, 
   3.81984575905723*^9}, {3.819845872661805*^9, 3.819845874154104*^9}, {
   3.819845918775814*^9, 3.8198459192120934`*^9}, {3.819846063341362*^9, 
   3.8198460642482643`*^9}, {3.819893393602768*^9, 3.81989342891319*^9}, {
   3.819893630569206*^9, 3.819893669786021*^9}, {3.819893706033174*^9, 
   3.819894026506311*^9}, {3.8198941014018183`*^9, 3.819894103278019*^9}, {
   3.8198941452803497`*^9, 3.81989420302125*^9}, {3.8198942531006813`*^9, 
   3.819894259603096*^9}, {3.819894351485725*^9, 3.819894374150814*^9}, {
   3.819894417976314*^9, 3.8198944379503717`*^9}, {3.819894510457963*^9, 
   3.819894531342198*^9}, {3.819894616908896*^9, 3.8198946188556147`*^9}, {
   3.81989467443762*^9, 3.8198946746667967`*^9}, {3.819894726950671*^9, 
   3.819894727350627*^9}, {3.819894856143846*^9, 3.81989485695214*^9}, {
   3.819894909930462*^9, 3.8198949163385572`*^9}, 3.819894988434752*^9, {
   3.819895045828321*^9, 3.819895055532596*^9}, {3.819895939608379*^9, 
   3.8198959942196407`*^9}, {3.819896041245577*^9, 3.819896041495573*^9}, {
   3.82006609886145*^9, 3.8200660993774843`*^9}, {3.820066386045842*^9, 
   3.82006640246625*^9}, {3.820066463475115*^9, 3.820066466881043*^9}, {
   3.820066654462879*^9, 3.820066737765512*^9}, {3.8200667862612867`*^9, 
   3.8200668241930237`*^9}, {3.820066871532098*^9, 
   3.820066929201416*^9}},ExpressionUUID->"b200aaa9-eaa2-4a4e-a2df-\
21a9a4208b86"]
},
WindowSize->{Full, Full},
WindowMargins->{{172, Automatic}, {Automatic, 50}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 10738, 220, 451, "Input",ExpressionUUID->"b200aaa9-eaa2-4a4e-a2df-21a9a4208b86"]
}
]
*)

(* End of internal cache information *)

